<?xml version="1.0" encoding="UTF-8"?><xdd:delta xmlns:xdd="http://codinuum.com/diffts/delta/" xdd:reversible="false" xdd:normalized="false" xdd:lang="java" xdd:digest="MD5_5fcad544e72647795eab8258ba3d0949" xdd:digest_="MD5_913eff9e31a86aa72b822cfcde60fa27"><xdd:insert xdd:stid="0" xdd:path="2/0/1/60_4"><MethodDeclaration name="assertHasRefreshBlock" ___signature="(LIndexMetadata;LClusterState;LTransportVersion;)Z"><Modifiers><Private/></Modifiers><BooleanType/><Parameters name="(LIndexMetadata;LClusterState;LTransportVersion;)Z"><Parameter name="indexMetadata" dims="0" va="false"><ReferenceType name="IndexMetadata"/></Parameter><Parameter name="clusterState" dims="0" va="false"><ReferenceType name="ClusterState"/></Parameter><Parameter name="minTransportVersion" dims="0" va="false"><ReferenceType name="TransportVersion"/></Parameter></Parameters><MethodBody><LocalVariableDeclarationStatement name="hasRefreshBlock[0"><ReferenceType name="var"/><VariableDeclarator name="hasRefreshBlock" dims="0"><PrimaryMethodInvocation name="hasIndexBlock"><PrimaryMethodInvocation name="blocks"><Name name="clusterState"/><Arguments/></PrimaryMethodInvocation><Arguments><PrimaryMethodInvocation name="getName"><PrimaryMethodInvocation name="getIndex"><Name name="indexMetadata"/><Arguments/></PrimaryMethodInvocation><Arguments/></PrimaryMethodInvocation><Name name="IndexMetadata.INDEX_REFRESH_BLOCK"><Name name="IndexMetadata"/></Name></Arguments></PrimaryMethodInvocation></VariableDeclarator></LocalVariableDeclarationStatement><IfStatement><Or><Eq><SimpleMethodInvocation name="useRefreshBlock"><Arguments><FieldAccess name="settings"/></Arguments></SimpleMethodInvocation><False/></Eq><Eq><SimpleMethodInvocation name="applyRefreshBlock"><Arguments><Name name="indexMetadata"/><Name name="minTransportVersion"/></Arguments></SimpleMethodInvocation><False/></Eq></Or><Block><AssertStatement><Eq><Name name="hasRefreshBlock"/><False/></Eq><PrimaryMethodInvocation name="getIndex"><Name name="indexMetadata"/><Arguments/></PrimaryMethodInvocation></AssertStatement></Block><ElseStatement><Block><AssertStatement><Name name="hasRefreshBlock"/><PrimaryMethodInvocation name="getIndex"><Name name="indexMetadata"/><Arguments/></PrimaryMethodInvocation></AssertStatement></Block></ElseStatement></IfStatement><ReturnStatement><True/></ReturnStatement></MethodBody></MethodDeclaration></xdd:insert><xdd:insert xdd:stid="1" xdd:path="2/0/1/60_3"><MethodDeclaration name="applyRefreshBlock" ___signature="(LIndexMetadata;LTransportVersion;)Z"><Modifiers><Private/><Static/></Modifiers><BooleanType/><Parameters name="(LIndexMetadata;LTransportVersion;)Z"><Parameter name="indexMetadata" dims="0" va="false"><ReferenceType name="IndexMetadata"/></Parameter><Parameter name="minClusterTransportVersion" dims="0" va="false"><ReferenceType name="TransportVersion"/></Parameter></Parameters><MethodBody><ReturnStatement><And><And><And><Lt><IntegerLiteral value="0"/><PrimaryMethodInvocation name="getNumberOfReplicas"><Name name="indexMetadata"/><Arguments/></PrimaryMethodInvocation></Lt><Eq><PrimaryMethodInvocation name="getResizeSourceIndex"><Name name="indexMetadata"/><Arguments/></PrimaryMethodInvocation><NullLiteral/></Eq></And><PrimaryMethodInvocation name="allMatch"><PrimaryMethodInvocation name="stream"><PrimaryMethodInvocation name="values"><PrimaryMethodInvocation name="getInSyncAllocationIds"><Name name="indexMetadata"/><Arguments/></PrimaryMethodInvocation><Arguments/></PrimaryMethodInvocation><Arguments/></PrimaryMethodInvocation><Arguments><NameMethodReference name="Set" ident="isEmpty"/></Arguments></PrimaryMethodInvocation></And><PrimaryMethodInvocation name="onOrAfter"><Name name="minClusterTransportVersion"/><Arguments><Name name="TransportVersions.NEW_REFRESH_CLUSTER_BLOCK"><Name name="TransportVersions"/></Name></Arguments></PrimaryMethodInvocation></And></ReturnStatement></MethodBody></MethodDeclaration></xdd:insert><xdd:insert xdd:stid="2" xdd:path="2/0/1/60_2"><MethodDeclaration name="createClusterBlocksTransformerForIndexCreation" ___signature="(LSettings;)LClusterBlocksTransformer;"><Modifiers><Static/></Modifiers><ReferenceType name="ClusterBlocksTransformer"/><Parameters name="(LSettings;)LClusterBlocksTransformer;"><Parameter name="settings" dims="0" va="false"><ReferenceType name="Settings"/></Parameter></Parameters><MethodBody><IfStatement><Eq><SimpleMethodInvocation name="useRefreshBlock"><Arguments><Name name="settings"/></Arguments></SimpleMethodInvocation><False/></Eq><Block><ReturnStatement><Lambda><InferredFormalParameters><InferredFormalParameter name="clusterBlocks"/><InferredFormalParameter name="indexMetadata"/><InferredFormalParameter name="minClusterTransportVersion"/></InferredFormalParameters><Block/></Lambda></ReturnStatement></Block></IfStatement><PrimaryMethodInvocationStatement name="debug"><Name name="logger"/><Arguments><StringLiteral value="YXBwbHlpbmcgcmVmcmVzaCBibG9jayBvbiBpbmRleCBjcmVhdGlvbg=="/></Arguments></PrimaryMethodInvocationStatement><ReturnStatement><Lambda><InferredFormalParameters><InferredFormalParameter name="clusterBlocks"/><InferredFormalParameter name="indexMetadata"/><InferredFormalParameter name="minClusterTransportVersion"/></InferredFormalParameters><Block><IfStatement><SimpleMethodInvocation name="applyRefreshBlock"><Arguments><Name name="indexMetadata"/><Name name="minClusterTransportVersion"/></Arguments></SimpleMethodInvocation><Block><PrimaryMethodInvocationStatement name="addIndexBlock"><Name name="clusterBlocks"/><Arguments><PrimaryMethodInvocation name="getName"><PrimaryMethodInvocation name="getIndex"><Name name="indexMetadata"/><Arguments/></PrimaryMethodInvocation><Arguments/></PrimaryMethodInvocation><Name name="IndexMetadata.INDEX_REFRESH_BLOCK"><Name name="IndexMetadata"/></Name></Arguments></PrimaryMethodInvocationStatement></Block></IfStatement></Block></Lambda></ReturnStatement></MethodBody></MethodDeclaration></xdd:insert><xdd:insert xdd:stid="3" xdd:path="2/0/1/60_1"><MethodDeclaration name="useRefreshBlock" ___signature="(LSettings;)Z"><Modifiers><Private/><Static/></Modifiers><BooleanType/><Parameters name="(LSettings;)Z"><Parameter name="settings" dims="0" va="false"><ReferenceType name="Settings"/></Parameter></Parameters><MethodBody><ReturnStatement><And><TypeMethodInvocation name="DiscoveryNode" ident="isStateless"><ClassType name="DiscoveryNode"/><Arguments><Name name="settings"/></Arguments></TypeMethodInvocation><PrimaryMethodInvocation name="getAsBoolean"><Name name="settings"/><Arguments><Name name="USE_INDEX_REFRESH_BLOCK_SETTING_NAME"/><False/></Arguments></PrimaryMethodInvocation></And></ReturnStatement></MethodBody></MethodDeclaration></xdd:insert><xdd:insert xdd:stid="4" xdd:path="2/0/1/42/3/3_1"><IfStatement><NotEq><Name name="blocksTransformer"/><NullLiteral/></NotEq><Block><PrimaryMethodInvocationStatement name="apply"><Name name="blocksTransformer"/><Arguments><Name name="blocksBuilder"/><Name name="indexMetadata"/><PrimaryMethodInvocation name="getMinTransportVersion"><Name name="currentState"/><Arguments/></PrimaryMethodInvocation></Arguments></PrimaryMethodInvocationStatement></Block></IfStatement></xdd:insert><xdd:insert xdd:stid="5" xdd:path="2/0/1/42/2/2_1"><Parameter name="blocksTransformer" dims="0" va="false"><ReferenceType name="ClusterBlocksTransformer"/></Parameter></xdd:insert><xdd:insert xdd:stid="6" xdd:path="2/0/1/26/4/1/0/2/1/1/6_1"><AssertStatement><SimpleMethodInvocation name="assertHasRefreshBlock"><Arguments><Name name="indexMetadata"/><Name name="updated"/><PrimaryMethodInvocation name="getMinTransportVersion"><Name name="updated"/><Arguments/></PrimaryMethodInvocation></Arguments></SimpleMethodInvocation></AssertStatement></xdd:insert><xdd:insert xdd:stid="7" xdd:path="2/0/1/26/4/1/0/2/1/1/6/1/0/0/2_1"><FieldAccess name="blocksTransformerUponIndexCreation"/></xdd:insert><xdd:insert xdd:stid="8" xdd:path="2/0/1/15/2/11_1"><AssignStatement tid=""><FieldAccess name="blocksTransformerUponIndexCreation"><This/></FieldAccess><SimpleMethodInvocation name="createClusterBlocksTransformerForIndexCreation"><Arguments><Name name="settings"/></Arguments></SimpleMethodInvocation></AssignStatement></xdd:insert><xdd:insert xdd:stid="9" xdd:path="2/0/1/14_1"><FieldDeclaration name="blocksTransformerUponIndexCreation[0"><Modifiers><Private/><Final/></Modifiers><ReferenceType name="ClusterBlocksTransformer"/><VariableDeclarator name="blocksTransformerUponIndexCreation" dims="0"/></FieldDeclaration></xdd:insert><xdd:insert xdd:stid="10" xdd:path="2/0/1/2_2"><InterfaceDeclaration name="ClusterBlocksTransformer"><InterfaceSpecifier name="ClusterBlocksTransformer"><Modifiers><MarkerAnnotation name="FunctionalInterface"/></Modifiers></InterfaceSpecifier><InterfaceBody name="ClusterBlocksTransformer"><MethodDeclaration name="apply" ___signature="(LClusterBlocks.Builder;LIndexMetadata;LTransportVersion;)V"><Void/><Parameters name="(LClusterBlocks.Builder;LIndexMetadata;LTransportVersion;)V"><Parameter name="clusterBlocks" dims="0" va="false"><ReferenceType name="ClusterBlocks.Builder"/></Parameter><Parameter name="indexMetadata" dims="0" va="false"><ReferenceType name="IndexMetadata"/></Parameter><Parameter name="minClusterTransportVersion" dims="0" va="false"><ReferenceType name="TransportVersion"/></Parameter></Parameters></MethodDeclaration></InterfaceBody></InterfaceDeclaration></xdd:insert><xdd:insert xdd:stid="11" xdd:path="2/0/1/2_1"><FieldDeclaration name="USE_INDEX_REFRESH_BLOCK_SETTING_NAME[0"><Modifiers><Public/><Static/><Final/></Modifiers><ReferenceType name="String"/><VariableDeclarator name="USE_INDEX_REFRESH_BLOCK_SETTING_NAME" dims="0"><StringLiteral value="c3RhdGVsZXNzLmluZGljZXMudXNlX3JlZnJlc2hfYmxvY2tfdXBvbl9pbmRleF9jcmVhdGlvbg=="/></VariableDeclarator></FieldDeclaration></xdd:insert><xdd:insert xdd:stid="12" xdd:path="1/18_1"><SingleTypeImportDeclaration name="org.elasticsearch.cluster.node.DiscoveryNode"/></xdd:insert></xdd:delta>