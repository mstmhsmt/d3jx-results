package gov.nasa.arc.mct.fastplot.bridge;
import gov.nasa.arc.mct.fastplot.bridge.PlotConstants.AxisOrientationSetting;
import gov.nasa.arc.mct.fastplot.bridge.PlotConstants.PanDirection;
import gov.nasa.arc.mct.fastplot.bridge.PlotConstants.PlotDisplayState;
import gov.nasa.arc.mct.fastplot.bridge.PlotConstants.ZoomDirection;
import gov.nasa.arc.mct.fastplot.settings.PlotSettings;
import gov.nasa.arc.mct.fastplot.view.Axis;
import gov.nasa.arc.mct.fastplot.view.PinSupport;
import java.util.GregorianCalendar;
import org.mockito.Mock;
import org.mockito.Mockito;
import org.mockito.MockitoAnnotations;
import org.testng.Assert;
import org.testng.annotations.BeforeMethod;
import org.testng.annotations.Test;
import plotter.xy.XYAxis;
import gov.nasa.arc.mct.fastplot.bridge.PlotConstants.LimitAlarmState;
import java.awt.Color;

public class TestPanAndZoomManager {
  @Mock private PlotAbstraction plotAbstraction;

  private PlotterPlot plotTimeOnX;

  private PlotterPlot plotTimeOnY;

  PanAndZoomManager panAndZoomManagerTimeOnX;

  PanAndZoomManager panAndZoomManagerTimeOnY;

  @BeforeMethod public void setup() {
    MockitoAnnotations.initMocks(this);
    PinSupport pins = new PinSupport();
    Mockito.when(plotAbstraction.getCurrentMCTTime()).thenReturn(new GregorianCalendar().getTimeInMillis());
    Mockito.when(plotAbstraction.getTimeAxis()).thenReturn(new Axis());
    Mockito.when(plotAbstraction.getTimeAxisUserPin()).thenReturn(pins.createPin());
    PlotSettings settings = new PlotSettings();
    settings.setAxisOrientationSetting(AxisOrientationSetting.X_AXIS_AS_TIME);
    settings.setMaxNonTime(100);
    settings.setMinNonTime(0);
    PlotAbstraction testPlotTimeX = new PlotView.Builder(PlotterPlot.class).plotSettings(settings).
    build()
    ;
    plotTimeOnX = (PlotterPlot) testPlotTimeX.returnPlottingPackage();
    plotTimeOnX.plotAbstraction = plotAbstraction;
    panAndZoomManagerTimeOnX = plotTimeOnX.panAndZoomManager;
    PlotSettings settings2 = new PlotSettings();
    settings.setAxisOrientationSetting(AxisOrientationSetting.Y_AXIS_AS_TIME);
    settings.setMaxNonTime(100);
    settings.setMinNonTime(0);
    PlotAbstraction testPlotTimeY = new PlotView.Builder(PlotterPlot.class).plotSettings(settings2).
    build()
    ;
    plotTimeOnY = (PlotterPlot) testPlotTimeY.returnPlottingPackage();
    plotTimeOnY.plotAbstraction = plotAbstraction;
    panAndZoomManagerTimeOnY = plotTimeOnY.panAndZoomManager;
  }

  @Test public void TestEnteringPanMode() {
    plotTimeOnX.setPlotDisplayState(PlotDisplayState.DISPLAY_ONLY);
    panAndZoomManagerTimeOnX.enteredPanMode();
    Assert.assertEquals(plotTimeOnX.getPlotDisplayState(), PlotDisplayState.USER_INTERACTION);
    Assert.assertEquals(plotTimeOnX.getNonTimeMaxAlarmState(), LimitAlarmState.NO_ALARM);
    panAndZoomManagerTimeOnX.exitedPanMode();
  }

  @Test public void TestEnteringZoomMode() {
    plotTimeOnX.setPlotDisplayState(PlotDisplayState.DISPLAY_ONLY);
    panAndZoomManagerTimeOnX.enteredZoomMode();
    Assert.assertEquals(plotTimeOnX.getPlotDisplayState(), PlotDisplayState.USER_INTERACTION);
    Assert.assertEquals(plotTimeOnX.getNonTimeMaxAlarmState(), LimitAlarmState.NO_ALARM);
    panAndZoomManagerTimeOnX.exitedZoomMode();
  }

  @Test public void TestPanningActionsTimeOnX() {
    XYAxis xAxis = plotTimeOnX.plotView.getXAxis();
    XYAxis yAxis = plotTimeOnX.plotView.getYAxis();
    double xStart = xAxis.getStart();
    double xStop = xAxis.getEnd();
    double yStart = yAxis.getStart();
    double yStop = yAxis.getEnd();
    panAndZoomManagerTimeOnX.panAction(PanDirection.PAN_HIGHER_X_AXIS);
    double newXStart = xAxis.getStart();
    double newXStop = xAxis.getEnd();
    double newYStart = yAxis.getStart();
    double newYStop = yAxis.getEnd();
    Assert.assertTrue(newXStart > xStart);
    Assert.assertTrue(newXStop > xStop);
    Assert.assertEquals(newYStart, yStart);
    Assert.assertEquals(newYStop, yStop);
    panAndZoomManagerTimeOnX.panAction(PanDirection.PAN_LOWER_X_AXIS);
    newXStart = xAxis.getStart();
    newXStop = xAxis.getEnd();
    newYStart = yAxis.getStart();
    newYStop = yAxis.getEnd();
    Assert.assertEquals(newXStart, xStart);
    Assert.assertEquals(newXStop, xStop);
    Assert.assertEquals(newYStart, yStart);
    Assert.assertEquals(newYStop, yStop);
    panAndZoomManagerTimeOnX.panAction(PanDirection.PAN_LOWER_X_AXIS);
    newXStart = xAxis.getStart();
    newXStop = xAxis.getEnd();
    newYStart = yAxis.getStart();
    newYStop = yAxis.getEnd();
    Assert.assertTrue(newXStart < xStart);
    Assert.assertTrue(newXStop < xStop);
    Assert.assertEquals(newYStart, yStart);
    Assert.assertEquals(newYStop, yStop);
    panAndZoomManagerTimeOnX.panAction(PanDirection.PAN_HIGHER_X_AXIS);
    newXStart = xAxis.getStart();
    newXStop = xAxis.getEnd();
    newYStart = yAxis.getStart();
    newYStop = yAxis.getEnd();
    Assert.assertEquals(newYStart, yStart);
    Assert.assertEquals(newYStop, yStop);
    Assert.assertEquals(newXStart, xStart);
    Assert.assertEquals(newXStop, xStop);
    panAndZoomManagerTimeOnX.panAction(PanDirection.PAN_HIGHER_Y_AXIS);
    newXStart = xAxis.getStart();
    newXStop = xAxis.getEnd();
    newYStart = yAxis.getStart();
    newYStop = yAxis.getEnd();
    Assert.assertTrue(newYStart > yStart);
    Assert.assertTrue(newYStop > yStop);
    Assert.assertEquals(newXStart, xStart);
    Assert.assertEquals(newXStop, xStop);
    panAndZoomManagerTimeOnX.panAction(PanDirection.PAN_LOWER_Y_AXIS);
    newXStart = xAxis.getStart();
    newXStop = xAxis.getEnd();
    newYStart = yAxis.getStart();
    newYStop = yAxis.getEnd();
    Assert.assertEquals(newYStart, yStart);
    Assert.assertEquals(newYStop, yStop);
    Assert.assertEquals(newXStart, xStart);
    Assert.assertEquals(newXStop, xStop);
    panAndZoomManagerTimeOnX.panAction(PanDirection.PAN_LOWER_Y_AXIS);
    newXStart = xAxis.getStart();
    newXStop = xAxis.getEnd();
    newYStart = yAxis.getStart();
    newYStop = yAxis.getEnd();
    Assert.assertTrue(newYStart < yStart);
    Assert.assertTrue(newYStop < yStop);
    Assert.assertEquals(newXStart, xStart);
    Assert.assertEquals(newXStop, xStop);
  }

  @Test public void TestPanningActionsTimeOnY() {
    XYAxis xAxis = plotTimeOnY.plotView.getXAxis();
    XYAxis yAxis = plotTimeOnY.plotView.getYAxis();
    double xStart = xAxis.getStart();
    double xStop = xAxis.getEnd();
    double yStart = yAxis.getStart();
    double yStop = yAxis.getEnd();
    panAndZoomManagerTimeOnY.panAction(PanDirection.PAN_HIGHER_X_AXIS);
    double newXStart = xAxis.getStart();
    double newXStop = xAxis.getEnd();
    double newYStart = yAxis.getStart();
    double newYStop = yAxis.getEnd();
    Assert.assertTrue(newXStart > xStart);
    Assert.assertTrue(newXStop > xStop);
    Assert.assertEquals(newYStart, yStart);
    Assert.assertEquals(newYStop, yStop);
    panAndZoomManagerTimeOnY.panAction(PanDirection.PAN_LOWER_X_AXIS);
    newXStart = xAxis.getStart();
    newXStop = xAxis.getEnd();
    newYStart = yAxis.getStart();
    newYStop = yAxis.getEnd();
    Assert.assertEquals(newXStart, xStart);
    Assert.assertEquals(newXStop, xStop);
    Assert.assertEquals(newYStart, yStart);
    Assert.assertEquals(newYStop, yStop);
    panAndZoomManagerTimeOnY.panAction(PanDirection.PAN_LOWER_X_AXIS);
    newXStart = xAxis.getStart();
    newXStop = xAxis.getEnd();
    newYStart = yAxis.getStart();
    newYStop = yAxis.getEnd();
    Assert.assertTrue(newXStart < xStart);
    Assert.assertTrue(newXStop < xStop);
    Assert.assertEquals(newYStart, yStart);
    Assert.assertEquals(newYStop, yStop);
    panAndZoomManagerTimeOnY.panAction(PanDirection.PAN_HIGHER_X_AXIS);
    newXStart = xAxis.getStart();
    newXStop = xAxis.getEnd();
    newYStart = yAxis.getStart();
    newYStop = yAxis.getEnd();
    Assert.assertEquals(newYStart, yStart);
    Assert.assertEquals(newYStop, yStop);
    Assert.assertEquals(newXStart, xStart);
    Assert.assertEquals(newXStop, xStop);
    panAndZoomManagerTimeOnY.panAction(PanDirection.PAN_HIGHER_Y_AXIS);
    newXStart = xAxis.getStart();
    newXStop = xAxis.getEnd();
    newYStart = yAxis.getStart();
    newYStop = yAxis.getEnd();
    Assert.assertTrue(newYStart > yStart);
    Assert.assertTrue(newYStop > yStop);
    Assert.assertEquals(newXStart, xStart);
    Assert.assertEquals(newXStop, xStop);
    panAndZoomManagerTimeOnY.panAction(PanDirection.PAN_LOWER_Y_AXIS);
    newXStart = xAxis.getStart();
    newXStop = xAxis.getEnd();
    newYStart = yAxis.getStart();
    newYStop = yAxis.getEnd();
    Assert.assertEquals(newYStart, yStart);
    Assert.assertEquals(newYStop, yStop);
    Assert.assertEquals(newXStart, xStart);
    Assert.assertEquals(newXStop, xStop);
    panAndZoomManagerTimeOnY.panAction(PanDirection.PAN_LOWER_Y_AXIS);
    newXStart = xAxis.getStart();
    newXStop = xAxis.getEnd();
    newYStart = yAxis.getStart();
    newYStop = yAxis.getEnd();
    Assert.assertTrue(newYStart < yStart);
    Assert.assertTrue(newYStop < yStop);
    Assert.assertEquals(newXStart, xStart);
    Assert.assertEquals(newXStop, xStop);
  }

  @Test public void TestZoomingActionsTimeX() {
    XYAxis xAxis = plotTimeOnX.plotView.getXAxis();
    XYAxis yAxis = plotTimeOnX.plotView.getYAxis();
    double xStart = xAxis.getStart();
    double xStop = xAxis.getEnd();
    double yStart = yAxis.getStart();
    double yStop = yAxis.getEnd();
    panAndZoomManagerTimeOnX.zoomAction(ZoomDirection.ZOOM_IN_HIGH_Y_AXIS);
    double newXStart = xAxis.getStart();
    double newXStop = xAxis.getEnd();
    double newYStart = yAxis.getStart();
    double newYStop = yAxis.getEnd();
    Assert.assertEquals(newYStart, yStart);
    Assert.assertTrue(newYStop < yStop);
    Assert.assertEquals(newXStart, xStart);
    Assert.assertEquals(newXStop, xStop);
    panAndZoomManagerTimeOnX.zoomAction(ZoomDirection.ZOOM_OUT_HIGH_Y_AXIS);
    panAndZoomManagerTimeOnX.zoomAction(ZoomDirection.ZOOM_OUT_HIGH_Y_AXIS);
    newXStart = xAxis.getStart();
    newXStop = xAxis.getEnd();
    newYStart = yAxis.getStart();
    newYStop = yAxis.getEnd();
    Assert.assertEquals(newYStart, yStart);
    Assert.assertTrue(newYStop > yStop);
    Assert.assertEquals(newXStart, xStart);
    Assert.assertEquals(newXStop, xStop);
    panAndZoomManagerTimeOnX.zoomAction(ZoomDirection.ZOOM_IN_CENTER_Y_AXIS);
    newXStart = xAxis.getStart();
    newXStop = xAxis.getEnd();
    newYStart = yAxis.getStart();
    newYStop = yAxis.getEnd();
    Assert.assertTrue(newYStart > yStart);
    Assert.assertTrue(newYStop < yStop);
    Assert.assertEquals(newXStart, xStart);
    Assert.assertEquals(newXStop, xStop);
    panAndZoomManagerTimeOnX.zoomAction(ZoomDirection.ZOOM_OUT_CENTER_Y_AXIS);
    panAndZoomManagerTimeOnX.zoomAction(ZoomDirection.ZOOM_OUT_CENTER_Y_AXIS);
    newXStart = xAxis.getStart();
    newXStop = xAxis.getEnd();
    newYStart = yAxis.getStart();
    newYStop = yAxis.getEnd();
    Assert.assertTrue(newYStart < yStart);
    Assert.assertTrue(newYStop > yStop);
    Assert.assertEquals(newXStart, xStart);
    Assert.assertEquals(newXStop, xStop);
    panAndZoomManagerTimeOnX.zoomAction(ZoomDirection.ZOOM_IN_LOW_Y_AXIS);
    panAndZoomManagerTimeOnX.zoomAction(ZoomDirection.ZOOM_IN_LOW_Y_AXIS);
    newXStart = xAxis.getStart();
    newXStop = xAxis.getEnd();
    newYStart = yAxis.getStart();
    newYStop = yAxis.getEnd();
    Assert.assertTrue(newYStart > yStart);
    Assert.assertTrue(newYStop > yStop);
    Assert.assertEquals(newXStart, xStart);
    Assert.assertEquals(newXStop, xStop);
    panAndZoomManagerTimeOnX.zoomAction(ZoomDirection.ZOOM_OUT_LOW_Y_AXIS);
    panAndZoomManagerTimeOnX.zoomAction(ZoomDirection.ZOOM_OUT_LOW_Y_AXIS);
    newXStart = xAxis.getStart();
    newXStop = xAxis.getEnd();
    newYStart = yAxis.getStart();
    newYStop = yAxis.getEnd();
    Assert.assertTrue(newYStart < yStart);
    Assert.assertTrue(newYStop > yStop);
    Assert.assertEquals(newXStart, xStart);
    Assert.assertEquals(newXStop, xStop);
    panAndZoomManagerTimeOnX.zoomAction(ZoomDirection.ZOOM_IN_LEFT_X_AXIS);
    panAndZoomManagerTimeOnX.zoomAction(ZoomDirection.ZOOM_IN_LEFT_X_AXIS);
    newXStart = xAxis.getStart();
    newXStop = xAxis.getEnd();
    newYStart = yAxis.getStart();
    newYStop = yAxis.getEnd();
    Assert.assertTrue(newYStart < yStart);
    Assert.assertTrue(newYStop > yStop);
    Assert.assertTrue(newXStart > xStart);
    Assert.assertEquals(newXStop, xStop);
    panAndZoomManagerTimeOnX.zoomAction(ZoomDirection.ZOOM_OUT_LEFT_X_AXIS);
    panAndZoomManagerTimeOnX.zoomAction(ZoomDirection.ZOOM_OUT_LEFT_X_AXIS);
    newXStart = xAxis.getStart();
    newXStop = xAxis.getEnd();
    newYStart = yAxis.getStart();
    newYStop = yAxis.getEnd();
    Assert.assertTrue(newYStart < yStart);
    Assert.assertTrue(newYStop > yStop);
    Assert.assertTrue(newXStart > xStart);
    Assert.assertEquals(newXStop, xStop);
    panAndZoomManagerTimeOnX.zoomAction(ZoomDirection.ZOOM_IN_CENTER_X_AXIS);
    newXStart = xAxis.getStart();
    newXStop = xAxis.getEnd();
    newYStart = yAxis.getStart();
    newYStop = yAxis.getEnd();
    Assert.assertTrue(newXStart > xStart);
    Assert.assertTrue(newXStop < xStop);
    Assert.assertTrue(newYStart < yStart);
    Assert.assertTrue(newYStop > yStop);
    panAndZoomManagerTimeOnX.zoomAction(ZoomDirection.ZOOM_OUT_CENTER_X_AXIS);
    newXStart = xAxis.getStart();
    newXStop = xAxis.getEnd();
    newYStart = yAxis.getStart();
    newYStop = yAxis.getEnd();
    Assert.assertTrue(newYStart < yStart);
    Assert.assertTrue(newYStop > yStop);
    Assert.assertTrue(newXStart > xStart);
    Assert.assertTrue(newXStop < xStop);
    panAndZoomManagerTimeOnX.zoomAction(ZoomDirection.ZOOM_IN_RIGHT_X_AXIS);
    newXStart = xAxis.getStart();
    newXStop = xAxis.getEnd();
    newYStart = yAxis.getStart();
    newYStop = yAxis.getEnd();
    Assert.assertTrue(newYStart < yStart);
    Assert.assertTrue(newYStop > yStop);
    Assert.assertTrue(newXStart > xStart);
    Assert.assertTrue(newXStop < xStop);
    panAndZoomManagerTimeOnX.zoomAction(ZoomDirection.ZOOM_OUT_RIGHT_X_AXIS);
    newXStart = xAxis.getStart();
    newXStop = xAxis.getEnd();
    newYStart = yAxis.getStart();
    newYStop = yAxis.getEnd();
    Assert.assertTrue(newYStart < yStart);
    Assert.assertTrue(newYStop > yStop);
    Assert.assertTrue(newXStart > xStart);
    Assert.assertTrue(newXStop < xStop);
  }

  @Test public void TestZoomingActionsTimeY() {
    XYAxis xAxis = plotTimeOnY.plotView.getXAxis();
    XYAxis yAxis = plotTimeOnY.plotView.getYAxis();
    double xStart = xAxis.getStart();
    double xStop = xAxis.getEnd();
    double yStart = yAxis.getStart();
    double yStop = yAxis.getEnd();
    panAndZoomManagerTimeOnY.zoomAction(ZoomDirection.ZOOM_IN_HIGH_Y_AXIS);
    double newXStart = xAxis.getStart();
    double newXStop = xAxis.getEnd();
    double newYStart = yAxis.getStart();
    double newYStop = yAxis.getEnd();
    Assert.assertEquals(newYStart, yStart);
    Assert.assertTrue(newYStop < yStop);
    Assert.assertEquals(newXStart, xStart);
    Assert.assertEquals(newXStop, xStop);
    panAndZoomManagerTimeOnY.zoomAction(ZoomDirection.ZOOM_OUT_HIGH_Y_AXIS);
    panAndZoomManagerTimeOnY.zoomAction(ZoomDirection.ZOOM_OUT_HIGH_Y_AXIS);
    newXStart = xAxis.getStart();
    newXStop = xAxis.getEnd();
    newYStart = yAxis.getStart();
    newYStop = yAxis.getEnd();
    Assert.assertEquals(newYStart, yStart);
    Assert.assertTrue(newYStop > yStop);
    Assert.assertEquals(newXStart, xStart);
    Assert.assertEquals(newXStop, xStop);
    panAndZoomManagerTimeOnY.zoomAction(ZoomDirection.ZOOM_IN_CENTER_Y_AXIS);
    newXStart = xAxis.getStart();
    newXStop = xAxis.getEnd();
    newYStart = yAxis.getStart();
    newYStop = yAxis.getEnd();
    Assert.assertTrue(newYStart > yStart);
    Assert.assertTrue(newYStop < yStop);
    Assert.assertEquals(newXStart, xStart);
    Assert.assertEquals(newXStop, xStop);
    panAndZoomManagerTimeOnY.zoomAction(ZoomDirection.ZOOM_OUT_CENTER_Y_AXIS);
    panAndZoomManagerTimeOnY.zoomAction(ZoomDirection.ZOOM_OUT_CENTER_Y_AXIS);
    newXStart = xAxis.getStart();
    newXStop = xAxis.getEnd();
    newYStart = yAxis.getStart();
    newYStop = yAxis.getEnd();
    Assert.assertTrue(newYStart < yStart);
    Assert.assertTrue(newYStop > yStop);
    Assert.assertEquals(newXStart, xStart);
    Assert.assertEquals(newXStop, xStop);
    panAndZoomManagerTimeOnY.zoomAction(ZoomDirection.ZOOM_IN_LOW_Y_AXIS);
    panAndZoomManagerTimeOnY.zoomAction(ZoomDirection.ZOOM_IN_LOW_Y_AXIS);
    newXStart = xAxis.getStart();
    newXStop = xAxis.getEnd();
    newYStart = yAxis.getStart();
    newYStop = yAxis.getEnd();
    Assert.assertTrue(newYStart > yStart);
    Assert.assertTrue(newYStop > yStop);
    Assert.assertEquals(newXStart, xStart);
    Assert.assertEquals(newXStop, xStop);
    panAndZoomManagerTimeOnY.zoomAction(ZoomDirection.ZOOM_OUT_LOW_Y_AXIS);
    panAndZoomManagerTimeOnY.zoomAction(ZoomDirection.ZOOM_OUT_LOW_Y_AXIS);
    newXStart = xAxis.getStart();
    newXStop = xAxis.getEnd();
    newYStart = yAxis.getStart();
    newYStop = yAxis.getEnd();
    Assert.assertTrue(newYStart < yStart);
    Assert.assertTrue(newYStop > yStop);
    Assert.assertEquals(newXStart, xStart);
    Assert.assertEquals(newXStop, xStop);
    panAndZoomManagerTimeOnY.zoomAction(ZoomDirection.ZOOM_IN_LEFT_X_AXIS);
    panAndZoomManagerTimeOnY.zoomAction(ZoomDirection.ZOOM_IN_LEFT_X_AXIS);
    newXStart = xAxis.getStart();
    newXStop = xAxis.getEnd();
    newYStart = yAxis.getStart();
    newYStop = yAxis.getEnd();
    Assert.assertTrue(newYStart < yStart);
    Assert.assertTrue(newYStop > yStop);
    Assert.assertTrue(newXStart > xStart);
    Assert.assertEquals(newXStop, xStop);
    panAndZoomManagerTimeOnY.zoomAction(ZoomDirection.ZOOM_OUT_LEFT_X_AXIS);
    panAndZoomManagerTimeOnY.zoomAction(ZoomDirection.ZOOM_OUT_LEFT_X_AXIS);
    newXStart = xAxis.getStart();
    newXStop = xAxis.getEnd();
    newYStart = yAxis.getStart();
    newYStop = yAxis.getEnd();
    Assert.assertTrue(newYStart < yStart);
    Assert.assertTrue(newYStop > yStop);
    Assert.assertTrue(newXStart > xStart);
    Assert.assertEquals(newXStop, xStop);
    panAndZoomManagerTimeOnY.zoomAction(ZoomDirection.ZOOM_IN_CENTER_X_AXIS);
    newXStart = xAxis.getStart();
    newXStop = xAxis.getEnd();
    newYStart = yAxis.getStart();
    newYStop = yAxis.getEnd();
    Assert.assertTrue(newXStart > xStart);
    Assert.assertTrue(newXStop < xStop);
    Assert.assertTrue(newYStart < yStart);
    Assert.assertTrue(newYStop > yStop);
    panAndZoomManagerTimeOnY.zoomAction(ZoomDirection.ZOOM_OUT_CENTER_X_AXIS);
    newXStart = xAxis.getStart();
    newXStop = xAxis.getEnd();
    newYStart = yAxis.getStart();
    newYStop = yAxis.getEnd();
    Assert.assertTrue(newYStart < yStart);
    Assert.assertTrue(newYStop > yStop);
    Assert.assertTrue(newXStart > xStart);
    Assert.assertTrue(newXStop < xStop);
    panAndZoomManagerTimeOnY.zoomAction(ZoomDirection.ZOOM_IN_RIGHT_X_AXIS);
    newXStart = xAxis.getStart();
    newXStop = xAxis.getEnd();
    newYStart = yAxis.getStart();
    newYStop = yAxis.getEnd();
    Assert.assertTrue(newYStart < yStart);
    Assert.assertTrue(newYStop > yStop);
    Assert.assertTrue(newXStart > xStart);
    Assert.assertTrue(newXStop < xStop);
    panAndZoomManagerTimeOnY.zoomAction(ZoomDirection.ZOOM_OUT_RIGHT_X_AXIS);
    newXStart = xAxis.getStart();
    newXStop = xAxis.getEnd();
    newYStart = yAxis.getStart();
    newYStop = yAxis.getEnd();
    Assert.assertTrue(newYStart < yStart);
    Assert.assertTrue(newYStop > yStop);
    Assert.assertTrue(newXStart > xStart);
    Assert.assertTrue(newXStop < xStop);
  }

  private long now = System.currentTimeMillis();

  @Test public void TestOutOfBoundsArrowsWithPanAndZoomActionsFixedNonTime() {
    now = System.currentTimeMillis();
    PlotAbstraction testPlotTimeX = new PlotView.Builder(PlotterPlot.class).axisOrientation(AxisOrientationSetting.X_AXIS_AS_TIME).nonTimeVaribleAxisMaxValue(100).nonTimeVaribleAxisMinValue(0).timeVariableAxisMinValue(now).timeVariableAxisMaxValue(now + 300000L).nonTimeAxisMinSubsequentSetting(PlotConstants.NonTimeAxisSubsequentBoundsSetting.FIXED).nonTimeAxisMaxSubsequentSetting(PlotConstants.NonTimeAxisSubsequentBoundsSetting.FIXED).build();
    plotTimeOnX = (PlotterPlot) testPlotTimeX.returnPlottingPackage();
    plotTimeOnX.plotAbstraction = plotAbstraction;
    panAndZoomManagerTimeOnX = plotTimeOnX.panAndZoomManager;
    plotTimeOnX.addDataSet("DataSet1", Color.RED);
    plotTimeOnX.addData("DataSet1", now + 10000L, 50);
    Assert.assertEquals(plotTimeOnX.getNonTimeMaxAlarmState(), LimitAlarmState.NO_ALARM);
    Assert.assertEquals(plotTimeOnX.getNonTimeMinAlarmState(), LimitAlarmState.NO_ALARM);
    panAndZoomManagerTimeOnX.panAction(PanDirection.PAN_HIGHER_X_AXIS);
    Assert.assertEquals(plotTimeOnX.getNonTimeMaxAlarmState(), LimitAlarmState.NO_ALARM);
    Assert.assertEquals(plotTimeOnX.getNonTimeMinAlarmState(), LimitAlarmState.NO_ALARM);
    panAndZoomManagerTimeOnX.panAction(PanDirection.PAN_LOWER_X_AXIS);
    Assert.assertEquals(plotTimeOnX.getNonTimeMaxAlarmState(), LimitAlarmState.NO_ALARM);
    Assert.assertEquals(plotTimeOnX.getNonTimeMinAlarmState(), LimitAlarmState.NO_ALARM);
    long time1 = now + 1L;
    plotTimeOnX.addData("DataSet1", time1, 150);
    plotTimeOnX.addData("DataSet1", time1, -50);
    Assert.assertEquals(plotTimeOnX.getNonTimeMaxAlarmState(), LimitAlarmState.ALARM_RAISED);
    Assert.assertEquals(plotTimeOnX.getNonTimeMinAlarmState(), LimitAlarmState.ALARM_RAISED);
    panAndZoomManagerTimeOnX.panAction(PanDirection.PAN_HIGHER_X_AXIS);
    Assert.assertEquals(plotTimeOnX.getNonTimeMaxAlarmState(), LimitAlarmState.NO_ALARM);
    Assert.assertEquals(plotTimeOnX.getNonTimeMinAlarmState(), LimitAlarmState.NO_ALARM);
    plotTimeOnX.addData("DataSet1", time1, 150);
    plotTimeOnX.addData("DataSet1", time1, -50);
    Assert.assertEquals(plotTimeOnX.getNonTimeMaxAlarmState(), LimitAlarmState.NO_ALARM);
    Assert.assertEquals(plotTimeOnX.getNonTimeMinAlarmState(), LimitAlarmState.NO_ALARM);
    panAndZoomManagerTimeOnX.panAction(PanDirection.PAN_LOWER_X_AXIS);
    plotTimeOnX.addData("DataSet1", time1, 150);
    plotTimeOnX.addData("DataSet1", time1, -50);
    Assert.assertEquals(plotTimeOnX.getNonTimeMaxAlarmState(), LimitAlarmState.ALARM_RAISED);
    Assert.assertEquals(plotTimeOnX.getNonTimeMinAlarmState(), LimitAlarmState.ALARM_RAISED);
    plotTimeOnX.clearAllDataFromPlot();
    plotTimeOnX.cornerResetButtonManager.resetX();
    panAndZoomManagerTimeOnX.zoomAction(ZoomDirection.ZOOM_IN_CENTER_X_AXIS);
    Assert.assertEquals(plotTimeOnX.getNonTimeMaxAlarmState(), LimitAlarmState.NO_ALARM);
    Assert.assertEquals(plotTimeOnX.getNonTimeMinAlarmState(), LimitAlarmState.NO_ALARM);
    panAndZoomManagerTimeOnX.zoomAction(ZoomDirection.ZOOM_IN_CENTER_X_AXIS);
    plotTimeOnX.addDataSet("DataSet1", Color.RED);
    long time2 = (plotTimeOnX.getCurrentTimeAxisMinAsLong() + plotTimeOnX.getCurrentTimeAxisMaxAsLong()) / 2L;
    plotTimeOnX.addData("DataSet1", time2, 150);
    plotTimeOnX.addData("DataSet1", time2, -50);
    Assert.assertEquals(plotTimeOnX.getNonTimeMaxAlarmState(), LimitAlarmState.ALARM_RAISED);
    Assert.assertEquals(plotTimeOnX.getNonTimeMinAlarmState(), LimitAlarmState.ALARM_RAISED);
    plotTimeOnX.clearAllDataFromPlot();
    plotTimeOnX.cornerResetButtonManager.resetX();
    plotTimeOnX.cornerResetButtonManager.resetY();
    Assert.assertEquals(plotTimeOnX.getNonTimeMaxAlarmState(), LimitAlarmState.NO_ALARM);
    Assert.assertEquals(plotTimeOnX.getNonTimeMinAlarmState(), LimitAlarmState.NO_ALARM);
    panAndZoomManagerTimeOnX.panAction(PanDirection.PAN_HIGHER_Y_AXIS);
    plotTimeOnX.addData("DataSet1", time2, 150);
    plotTimeOnX.addData("DataSet1", time2, -50);
    Assert.assertEquals(plotTimeOnX.getNonTimeMaxAlarmState(), LimitAlarmState.ALARM_RAISED);
    Assert.assertEquals(plotTimeOnX.getNonTimeMinAlarmState(), LimitAlarmState.ALARM_RAISED);
    plotTimeOnX.clearAllDataFromPlot();
    plotTimeOnX.cornerResetButtonManager.resetX();
    plotTimeOnX.cornerResetButtonManager.resetY();
    panAndZoomManagerTimeOnX.panAction(PanDirection.PAN_LOWER_Y_AXIS);
    plotTimeOnX.addData("DataSet1", time2, 150);
    plotTimeOnX.addData("DataSet1", time2, -50);
    Assert.assertEquals(plotTimeOnX.getNonTimeMaxAlarmState(), LimitAlarmState.ALARM_RAISED);
    Assert.assertEquals(plotTimeOnX.getNonTimeMinAlarmState(), LimitAlarmState.ALARM_RAISED);
    plotTimeOnX.clearAllDataFromPlot();
    plotTimeOnX.cornerResetButtonManager.resetX();
    plotTimeOnX.cornerResetButtonManager.resetY();
    Assert.assertEquals(plotTimeOnX.getNonTimeMaxAlarmState(), LimitAlarmState.NO_ALARM);
    Assert.assertEquals(plotTimeOnX.getNonTimeMinAlarmState(), LimitAlarmState.NO_ALARM);
    panAndZoomManagerTimeOnX.zoomAction(ZoomDirection.ZOOM_IN_CENTER_Y_AXIS);
    plotTimeOnX.addData("DataSet1", time2, 150);
    plotTimeOnX.addData("DataSet1", time2, -50);
    Assert.assertEquals(plotTimeOnX.getNonTimeMaxAlarmState(), LimitAlarmState.ALARM_RAISED);
    Assert.assertEquals(plotTimeOnX.getNonTimeMinAlarmState(), LimitAlarmState.ALARM_RAISED);
  }

  @Test public void TestOutOfBoundsArrowsWithPanAndZoomActionsAutoNonTime() {
    now = System.currentTimeMillis();
    PlotAbstraction testPlotTimeX = new PlotView.Builder(PlotterPlot.class).axisOrientation(AxisOrientationSetting.X_AXIS_AS_TIME).nonTimeVaribleAxisMaxValue(100).nonTimeVaribleAxisMinValue(0).timeVariableAxisMinValue(now).timeVariableAxisMaxValue(now + 300000L).nonTimeAxisMinSubsequentSetting(PlotConstants.NonTimeAxisSubsequentBoundsSetting.AUTO).nonTimeAxisMaxSubsequentSetting(PlotConstants.NonTimeAxisSubsequentBoundsSetting.AUTO).build();
    plotTimeOnX = (PlotterPlot) testPlotTimeX.returnPlottingPackage();
    plotTimeOnX.plotAbstraction = plotAbstraction;
    panAndZoomManagerTimeOnX = plotTimeOnX.panAndZoomManager;
    plotTimeOnX.addDataSet("DataSet1", Color.RED);
    plotTimeOnX.addData("DataSet1", now + 10000L, 50);
    Assert.assertEquals(plotTimeOnX.getNonTimeMaxAlarmState(), LimitAlarmState.NO_ALARM);
    Assert.assertEquals(plotTimeOnX.getNonTimeMinAlarmState(), LimitAlarmState.NO_ALARM);
    panAndZoomManagerTimeOnX.panAction(PanDirection.PAN_HIGHER_X_AXIS);
    Assert.assertEquals(plotTimeOnX.getNonTimeMaxAlarmState(), LimitAlarmState.NO_ALARM);
    Assert.assertEquals(plotTimeOnX.getNonTimeMinAlarmState(), LimitAlarmState.NO_ALARM);
    panAndZoomManagerTimeOnX.panAction(PanDirection.PAN_LOWER_X_AXIS);
    Assert.assertEquals(plotTimeOnX.getNonTimeMaxAlarmState(), LimitAlarmState.NO_ALARM);
    Assert.assertEquals(plotTimeOnX.getNonTimeMinAlarmState(), LimitAlarmState.NO_ALARM);
    long time1 = now + 1L;
    plotTimeOnX.cornerResetButtonManager.informResetXAndYActionSelected();
    plotTimeOnX.addData("DataSet1", time1, 150);
    plotTimeOnX.addData("DataSet1", time1, -50);
    Assert.assertEquals(plotTimeOnX.getNonTimeMaxAlarmState(), LimitAlarmState.NO_ALARM);
    Assert.assertEquals(plotTimeOnX.getNonTimeMinAlarmState(), LimitAlarmState.NO_ALARM);
    panAndZoomManagerTimeOnX.panAction(PanDirection.PAN_HIGHER_X_AXIS);
    Assert.assertEquals(plotTimeOnX.getNonTimeMaxAlarmState(), LimitAlarmState.NO_ALARM);
    Assert.assertEquals(plotTimeOnX.getNonTimeMinAlarmState(), LimitAlarmState.NO_ALARM);
    time1 = (plotTimeOnX.getCurrentTimeAxisMinAsLong() + plotTimeOnX.getCurrentTimeAxisMaxAsLong()) / 2L;
    plotTimeOnX.addData("DataSet1", time1, 150);
    plotTimeOnX.addData("DataSet1", time1, -50);
    Assert.assertEquals(plotTimeOnX.getNonTimeMaxAlarmState(), LimitAlarmState.ALARM_RAISED);
    Assert.assertEquals(plotTimeOnX.getNonTimeMinAlarmState(), LimitAlarmState.ALARM_RAISED);
    panAndZoomManagerTimeOnX.panAction(PanDirection.PAN_LOWER_X_AXIS);
    time1 = plotTimeOnX.getCurrentTimeAxisMaxAsLong() + 10000L;
    plotTimeOnX.addData("DataSet1", time1, 150);
    plotTimeOnX.addData("DataSet1", time1, -50);
    Assert.assertEquals(plotTimeOnX.getNonTimeMaxAlarmState(), LimitAlarmState.NO_ALARM);
    Assert.assertEquals(plotTimeOnX.getNonTimeMinAlarmState(), LimitAlarmState.NO_ALARM);
    plotTimeOnX.clearAllDataFromPlot();
    plotTimeOnX.cornerResetButtonManager.resetX();
    panAndZoomManagerTimeOnX.zoomAction(ZoomDirection.ZOOM_IN_CENTER_X_AXIS);
    Assert.assertEquals(plotTimeOnX.getNonTimeMaxAlarmState(), LimitAlarmState.NO_ALARM);
    Assert.assertEquals(plotTimeOnX.getNonTimeMinAlarmState(), LimitAlarmState.NO_ALARM);
    panAndZoomManagerTimeOnX.zoomAction(ZoomDirection.ZOOM_IN_CENTER_X_AXIS);
    plotTimeOnX.addDataSet("DataSet1", Color.RED);
    long time2 = (plotTimeOnX.getCurrentTimeAxisMinAsLong() + plotTimeOnX.getCurrentTimeAxisMaxAsLong()) / 2L;
    plotTimeOnX.addData("DataSet1", time2, 150);
    plotTimeOnX.addData("DataSet1", time2, -50);
    Assert.assertEquals(plotTimeOnX.getNonTimeMaxAlarmState(), LimitAlarmState.ALARM_RAISED);
    Assert.assertEquals(plotTimeOnX.getNonTimeMinAlarmState(), LimitAlarmState.ALARM_RAISED);
    plotTimeOnX.clearAllDataFromPlot();
    plotTimeOnX.cornerResetButtonManager.resetX();
    plotTimeOnX.cornerResetButtonManager.resetY();
    Assert.assertEquals(plotTimeOnX.getNonTimeMaxAlarmState(), LimitAlarmState.NO_ALARM);
    Assert.assertEquals(plotTimeOnX.getNonTimeMinAlarmState(), LimitAlarmState.NO_ALARM);
    plotTimeOnX.clearAllDataFromPlot();
    plotTimeOnX.cornerResetButtonManager.resetX();
    plotTimeOnX.cornerResetButtonManager.resetY();
    panAndZoomManagerTimeOnX.panAction(PanDirection.PAN_HIGHER_Y_AXIS);
    time2 = (plotTimeOnX.getCurrentTimeAxisMinAsLong() + plotTimeOnX.getCurrentTimeAxisMaxAsLong()) / 2L;
    double aboveMax = plotTimeOnX.getCurrentNonTimeAxisMax() + 100;
    double belowMin = plotTimeOnX.getCurrentNonTimeAxisMin() - 100;
    plotTimeOnX.addData("DataSet1", time2, aboveMax);
    plotTimeOnX.addData("DataSet1", time2, belowMin);
    Assert.assertEquals(plotTimeOnX.getNonTimeMaxAlarmState(), LimitAlarmState.ALARM_RAISED);
    Assert.assertEquals(plotTimeOnX.getNonTimeMinAlarmState(), LimitAlarmState.ALARM_RAISED);
    plotTimeOnX.clearAllDataFromPlot();
    plotTimeOnX.cornerResetButtonManager.resetX();
    plotTimeOnX.cornerResetButtonManager.resetY();
    panAndZoomManagerTimeOnX.panAction(PanDirection.PAN_LOWER_Y_AXIS);
    aboveMax = plotTimeOnX.getCurrentNonTimeAxisMax() + 100;
    belowMin = plotTimeOnX.getCurrentNonTimeAxisMin() - 100;
    plotTimeOnX.addData("DataSet1", time2, aboveMax);
    plotTimeOnX.addData("DataSet1", time2, belowMin);
    Assert.assertEquals(plotTimeOnX.getNonTimeMaxAlarmState(), LimitAlarmState.ALARM_RAISED);
    Assert.assertEquals(plotTimeOnX.getNonTimeMinAlarmState(), LimitAlarmState.ALARM_RAISED);
    plotTimeOnX.clearAllDataFromPlot();
    plotTimeOnX.cornerResetButtonManager.resetX();
    plotTimeOnX.cornerResetButtonManager.resetY();
    Assert.assertEquals(plotTimeOnX.getNonTimeMaxAlarmState(), LimitAlarmState.NO_ALARM);
    Assert.assertEquals(plotTimeOnX.getNonTimeMinAlarmState(), LimitAlarmState.NO_ALARM);
    panAndZoomManagerTimeOnX.zoomAction(ZoomDirection.ZOOM_IN_CENTER_Y_AXIS);
    time2 = (plotTimeOnX.getCurrentTimeAxisMinAsLong() + plotTimeOnX.getCurrentTimeAxisMaxAsLong()) / 2L;
    aboveMax = plotTimeOnX.getCurrentNonTimeAxisMax() + 100;
    belowMin = plotTimeOnX.getCurrentNonTimeAxisMin() - 100;
    plotTimeOnX.addData("DataSet1", time2, aboveMax);
    plotTimeOnX.addData("DataSet1", time2, belowMin);
    Assert.assertEquals(plotTimeOnX.getNonTimeMaxAlarmState(), LimitAlarmState.ALARM_RAISED);
    Assert.assertEquals(plotTimeOnX.getNonTimeMinAlarmState(), LimitAlarmState.ALARM_RAISED);
  }
}
