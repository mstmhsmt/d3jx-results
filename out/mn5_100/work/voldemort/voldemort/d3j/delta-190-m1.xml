<xdd:delta xmlns:xdd="http://codinuum.com/diffts/delta/" xdd:reversible="false" xdd:normalized="false" xdd:lang="java" xdd:digest="MD5_c67bc2de5f1754b8f9c8f0d5876d66c4" xdd:digest_=""><xdd:change xdd:path="2/0/1/9/2/9/1/1/0/0"><Name name="storageEngine" /></xdd:change><xdd:change xdd:path="2/0/1/13/4/0/1/0/0/0"><Name name="StreamRequestHandlerState" /></xdd:change><xdd:change xdd:path="2/0/1/13/4/0/1/0/0" xdd:boundary="0;1"><Name name="StreamRequestHandlerState.WRITING" /></xdd:change><xdd:change_attr xdd:path="2/0/1/13/4/1/2/1/2/2/1/3/1/0/1/0" xdd:attr="name" xdd:new_value="send_index_file" /><xdd:change xdd:path="2/0/1/13/4/1/2/1/2/2/1/8/1/0/1/0"><FieldAccess name="indexFile" /></xdd:change><xdd:change xdd:path="2/0/1/13/4/1/2/1/2/2/1/0/1/0/0/0"><FieldAccess name="currentPair" /></xdd:change><xdd:change xdd:path="2/0/1/13/4/1/2/1/2/2/1/0/1/0/0" xdd:boundary="0;1"><PrimaryMethodInvocation name="toString" /></xdd:change><xdd:change xdd:path="2/0/1/13/4/1/2/1/2/2/1/0/1/0/2" xdd:boundary="0;1"><PrimaryMethodInvocation name="toString" /></xdd:change><xdd:change xdd:path="2/0/1/13/4/1/2/1/2/2/1/0/1/0/4/1/0"><FieldAccess name="currentChunkId" /></xdd:change><xdd:change_attr xdd:path="2/0/1/13/4/1/2/1/2/2/1/4" xdd:attr="name" xdd:new_value="validateFiles" /><xdd:change xdd:path="2/0/1/13/4/1/2/1/2/2/1/5/1/0/1/0"><FieldAccess name="dataFile" /></xdd:change><xdd:change xdd:path="2/0/1/14/3/1/0/6/1/0/2/0/0/0"><FieldAccess name="fetchStatus" /></xdd:change><xdd:change xdd:path="2/0/1/14/3/1/0/6/1/0/2/0/0/1"><Name name="FetchStatus" /></xdd:change><xdd:change_attr xdd:path="2/0/1/14" xdd:attr="___signature" xdd:new_value="(LDataOutputStream;)V" /><xdd:change_attr xdd:path="2/0/1/14" xdd:attr="name" xdd:new_value="handleSendDataFile" /><xdd:change xdd:path="2/0/1/13/4/1/1" xdd:boundary="0;1"><Add /></xdd:change><xdd:change xdd:path="2/0/1/14/3/0" xdd:boundary="0;1"><FieldDeclaration name="dataChannel[0" /></xdd:change><xdd:change_attr xdd:path="2/0/1/14/3/1/0/3/1" xdd:attr="name" xdd:new_value="outChannel" /><xdd:change xdd:path="2/0/1/14/3/1/0/3" xdd:boundary="0;1"><FieldDeclaration name="outChannel[0" /></xdd:change><xdd:change_attr xdd:path="2/0/1/14/1/0" xdd:attr="name" xdd:new_value="fileToWrite" /><xdd:change xdd:path="2/0/1/14/3/1/0/3/1/0/1/0"><FieldAccess name="outStream" /></xdd:change><xdd:change xdd:path="2/0/1/14/3/1/0/0/1/0/0/0/1/0/0"><FieldAccess name="fileToWrite" /></xdd:change><xdd:change xdd:path="2/0/1/14/3/1/0/0/1/0/0/1/0/0"><FieldAccess name="dataChannel" /></xdd:change><xdd:change xdd:path="2/0/1/14/3/1/0/1/1/0"><FieldAccess name="outStream" /></xdd:change><xdd:change xdd:path="2/0/1/14/3/1/0/6/1/0/1/0/1/0/0"><FieldAccess name="dataChannel" /></xdd:change><xdd:insert xdd:stid="27" xdd:path="2/0/1/14_5"><ClassDeclaration name="ChunkedFileWriter"><ClassBody name="ChunkedFileWriter"><FieldDeclaration name="fileToWrite[0"><Modifiers><Private /><Final /></Modifiers><ReferenceType name="File" /><VariableDeclarator name="fileToWrite" dims="0" /></FieldDeclaration><FieldDeclaration name="outStream[0"><Modifiers><Private /><Final /></Modifiers><ReferenceType name="DataOutputStream" /><VariableDeclarator name="outStream" dims="0" /></FieldDeclaration><FieldDeclaration name="currentPos[0"><Modifiers><Private /></Modifiers><LongType /><VariableDeclarator name="currentPos" dims="0" /></FieldDeclaration><ConstructorDeclaration name="ChunkedFileWriter" ___signature=""><Throws name="ChunkedFileWriter.&lt;init&gt;"><ReferenceType name="FileNotFoundException" /></Throws><ConstructorBody><AssignStatement tid=""><FieldAccess name="fileToWrite"><This /></FieldAccess><Name name="fileToWrite" /></AssignStatement><AssignStatement tid=""><FieldAccess name="outStream"><This /></FieldAccess><Name name="stream" /></AssignStatement><AssignStatement tid=""><FieldAccess name="dataChannel"><This /></FieldAccess></AssignStatement><AssignStatement tid=""><FieldAccess name="outChannel"><This /></FieldAccess></AssignStatement><AssignStatement tid=""><FieldAccess name="currentPos"><This /></FieldAccess><IntegerLiteral value="0" /></AssignStatement></ConstructorBody></ConstructorDeclaration><MethodDeclaration name="close" ___signature="()V"><Modifiers><Public /></Modifiers><Void /><Parameters name="()V" /><Throws name="close"><ReferenceType name="IOException" /></Throws><MethodBody><PrimaryMethodInvocationStatement name="close"><FieldAccess name="dataChannel" /><Arguments /></PrimaryMethodInvocationStatement><PrimaryMethodInvocationStatement name="close"><FieldAccess name="outChannel" /><Arguments /></PrimaryMethodInvocationStatement></MethodBody></MethodDeclaration><MethodDeclaration name="writeHeader" ___signature="()V"><Void /><Parameters name="()V" /><Throws name="writeHeader"><ReferenceType name="IOException" /></Throws><MethodBody /></MethodDeclaration><MethodDeclaration name="streamFile" ___signature="()J"><LongType /><Parameters name="()J" /><Throws name="streamFile"><ReferenceType name="IOException" /></Throws><MethodBody><LocalVariableDeclarationStatement name="bytesRemaining[0"><LongType /><VariableDeclarator name="bytesRemaining" dims="0" /></LocalVariableDeclarationStatement><IfStatement><Lt><IntegerLiteral value="0" /><Name name="bytesRemaining" /></Lt><Block><LocalVariableDeclarationStatement name="bytesToWrite[0"><LongType /><VariableDeclarator name="bytesToWrite" dims="0"><TypeMethodInvocation name="Math" ident="min"><ClassType name="Math" /><Arguments><Name name="bytesRemaining" /></Arguments></TypeMethodInvocation></VariableDeclarator></LocalVariableDeclarationStatement><LocalVariableDeclarationStatement name="bytesWritten[0"><LongType /><VariableDeclarator name="bytesWritten" dims="0"><PrimaryMethodInvocation name="transferTo"><FieldAccess name="dataChannel" /><Arguments><FieldAccess name="currentPos" /><Name name="bytesToWrite" /><FieldAccess name="outChannel" /></Arguments></PrimaryMethodInvocation></VariableDeclarator></LocalVariableDeclarationStatement><AddAssignStatement tid=""><FieldAccess name="currentPos" /><Name name="bytesWritten" /></AddAssignStatement><PrimaryMethodInvocationStatement name="info"><FieldAccess name="logger" /><Arguments><Add><Name name="bytesWritten" /><StringLiteral value="IG9mIGJ5dGVzIHNlbnQ=" /></Add></Arguments></PrimaryMethodInvocationStatement><PrimaryMethodInvocationStatement name="maybeThrottle"><Arguments><Cast><IntType /><Name name="bytesWritten" /></Cast></Arguments></PrimaryMethodInvocationStatement></Block></IfStatement><AssignStatement tid=""><Name name="bytesRemaining" /><Subt><PrimaryMethodInvocation name="size"><FieldAccess name="dataChannel" /><Arguments /></PrimaryMethodInvocation><FieldAccess name="currentPos" /></Subt></AssignStatement><ReturnStatement><Name name="bytesRemaining" /></ReturnStatement></MethodBody></MethodDeclaration></ClassBody></ClassDeclaration></xdd:insert><xdd:insert xdd:stid="34" xdd:path="2/0/1/14_5/0/6/3/0/1/0/0_1" xdd:parent="m293" xdd:depth="1"><FieldAccess name="currentPos" /></xdd:insert><xdd:insert xdd:stid="45" xdd:path="2/0/1/14_5/0/3/1/2/1/0_-1" xdd:parent="m195" xdd:depth="1"><StandardInstanceCreation name="FileInputStream"><Arguments><Name name="fileToWrite" /></Arguments></StandardInstanceCreation></xdd:insert><xdd:insert xdd:stid="52" xdd:path="2/0/1/14_5/0/2/0_-1" xdd:parent="m260" xdd:depth="1"><Modifiers><Private /><Final /></Modifiers></xdd:insert><xdd:insert xdd:stid="55" xdd:path="2/0/1/14_5/0/2/0_-1" xdd:parent="m249" xdd:depth="1"><Modifiers><Private /><Final /></Modifiers></xdd:insert><xdd:insert xdd:stid="56" xdd:path="2/0/1/14_4"><EnumDeclaration name="FetchStatus"><EnumBody name="FetchStatus"><EnumConstant name="next_partition" /><EnumConstant name="send_data_file" /><EnumConstant name="send_index_file" /></EnumBody></EnumDeclaration></xdd:insert><xdd:insert xdd:stid="57" xdd:path="2/0/1/14_3"><MethodDeclaration name="isPartitionFinished" ___signature="()Z"><Modifiers><Private /></Modifiers><BooleanType /><Parameters name="()Z" /><MethodBody><LocalVariableDeclarationStatement name="finished[0"><BooleanType /><VariableDeclarator name="finished" dims="0" /></LocalVariableDeclarationStatement><IfStatement><And><And><Negation><PrimaryMethodInvocation name="exists"><FieldAccess name="indexFile" /><Arguments /></PrimaryMethodInvocation></Negation><Negation><PrimaryMethodInvocation name="exists"><FieldAccess name="dataFile" /><Arguments /></PrimaryMethodInvocation></Negation></And><Gt><FieldAccess name="currentChunkId" /><IntegerLiteral value="0" /></Gt></And><Block><AssignStatement tid=""><Name name="finished" /><True /></AssignStatement></Block></IfStatement><ReturnStatement><Name name="finished" /></ReturnStatement></MethodBody></MethodDeclaration></xdd:insert><xdd:insert xdd:stid="60" xdd:path="2/0/1/14_2"><MethodDeclaration name="validateFiles" ___signature="()V"><Modifiers><Private /></Modifiers><Void /><Parameters name="()V" /><MethodBody><IfStatement><And><And><Negation><PrimaryMethodInvocation name="exists"><FieldAccess name="indexFile" /><Arguments /></PrimaryMethodInvocation></Negation><Negation><PrimaryMethodInvocation name="exists"><FieldAccess name="dataFile" /><Arguments /></PrimaryMethodInvocation></Negation></And><Eq><IntegerLiteral value="0" /><FieldAccess name="currentChunkId" /></Eq></And><Block><ThrowStatement><StandardInstanceCreation name="VoldemortException"><ReferenceType name="VoldemortException" /><Arguments><NaryAdd><StringLiteral value="Q291bGQgbm90IGZpbmQgYW55IGRhdGEgZm9yIA==" /><PrimaryMethodInvocation name="toString"><PrimaryMethodInvocation name="getSecond"><FieldAccess name="currentPair" /><Arguments /></PrimaryMethodInvocation><Arguments /></PrimaryMethodInvocation><StringLiteral value="Xw==" /><PrimaryMethodInvocation name="toString"><PrimaryMethodInvocation name="getFirst"><FieldAccess name="currentPair" /><Arguments /></PrimaryMethodInvocation><Arguments /></PrimaryMethodInvocation><StringLiteral value="Xw==" /><FieldAccess name="currentChunkId" /></NaryAdd></Arguments></StandardInstanceCreation></ThrowStatement></Block></IfStatement><IfStatement><BitXor><PrimaryMethodInvocation name="exists"><FieldAccess name="indexFile" /><Arguments /></PrimaryMethodInvocation><PrimaryMethodInvocation name="exists"><FieldAccess name="dataFile" /><Arguments /></PrimaryMethodInvocation></BitXor><Block><ThrowStatement><StandardInstanceCreation name="VoldemortException"><ReferenceType name="VoldemortException" /><Arguments><NaryAdd><StringLiteral value="T25lIG9mIHRoZSBmb2xsb3dpbmcgZG9lcyBub3QgZXhpc3Q6IA==" /><PrimaryMethodInvocation name="toString"><FieldAccess name="indexFile" /><Arguments /></PrimaryMethodInvocation><StringLiteral value="IGFuZCA=" /><PrimaryMethodInvocation name="toString"><FieldAccess name="dataFile" /><Arguments /></PrimaryMethodInvocation><StringLiteral value="Lg==" /></NaryAdd></Arguments></StandardInstanceCreation></ThrowStatement></Block></IfStatement></MethodBody></MethodDeclaration></xdd:insert><xdd:insert xdd:stid="61" xdd:path="2/0/1/14_1"><MethodDeclaration name="handleNextPartition" ___signature="()LStreamRequestHandlerState;"><Modifiers><Private /></Modifiers><ReferenceType name="StreamRequestHandlerState" /><Parameters name="()LStreamRequestHandlerState;" /><MethodBody><LocalVariableDeclarationStatement name="handlerState[0"><ReferenceType name="StreamRequestHandlerState" /><VariableDeclarator name="handlerState" dims="0"><Name name="StreamRequestHandlerState.WRITING"><Name name="StreamRequestHandlerState" /></Name></VariableDeclarator></LocalVariableDeclarationStatement><IfStatement><PrimaryMethodInvocation name="hasNext"><FieldAccess name="partitionIterator" /><Arguments /></PrimaryMethodInvocation><Block><AssignStatement tid=""><FieldAccess name="currentPair" /><PrimaryMethodInvocation name="next"><FieldAccess name="partitionIterator" /><Arguments /></PrimaryMethodInvocation></AssignStatement><AssignStatement tid=""><FieldAccess name="currentChunkId" /><IntegerLiteral value="0" /></AssignStatement><AssignStatement tid=""><FieldAccess name="dataFile" /><Assign tid=""><FieldAccess name="indexFile" /><NullLiteral /></Assign></AssignStatement><AssignStatement tid=""><FieldAccess name="fetchStatus" /><Name name="FetchStatus.send_data_file"><Name name="FetchStatus" /></Name></AssignStatement></Block><ElseStatement><Block><PrimaryMethodInvocationStatement name="info"><FieldAccess name="logger" /><Arguments /></PrimaryMethodInvocationStatement><AssignStatement tid=""><Name name="handlerState" /><Name name="StreamRequestHandlerState.COMPLETE"><Name name="StreamRequestHandlerState" /></Name></AssignStatement></Block></ElseStatement></IfStatement><ReturnStatement><Name name="handlerState" /></ReturnStatement></MethodBody></MethodDeclaration></xdd:insert><xdd:insert xdd:stid="66" xdd:path="2/0/1/14_1/3/1/2/0/0/1/0/0_-1" xdd:parent="m251" xdd:depth="1"><StringLiteral value="RmluaXNoZWQgc3RyZWFtaW5nIGZpbGVzIGZvciBwYXJ0aXRpb25zOiA=" /></xdd:insert><xdd:insert xdd:stid="67" xdd:path="2/0/1/14/3/1/0/6/1/0/2" xdd:boundary="1_1"><IfStatement><Eq><IntegerLiteral value="0" /><PrimaryMethodInvocation name="streamFile"><FieldAccess name="chunkedFileWriter" /><Arguments /></PrimaryMethodInvocation></Eq><Block><PrimaryMethodInvocationStatement name="close"><FieldAccess name="chunkedFileWriter"><This /></FieldAccess></PrimaryMethodInvocationStatement><AssignStatement tid=""><FieldAccess name="chunkedFileWriter"><This /></FieldAccess><StandardInstanceCreation name="ChunkedFileWriter"><ReferenceType name="ChunkedFileWriter" /><Arguments><FieldAccess name="indexFile" /><Name name="outputStream" /></Arguments></StandardInstanceCreation></AssignStatement><PrimaryMethodInvocationStatement name="writeHeader"><FieldAccess name="chunkedFileWriter"><This /></FieldAccess><Arguments /></PrimaryMethodInvocationStatement><AssignStatement tid=""><FieldAccess name="fetchStatus" /><Name name="FetchStatus.send_index_file"><Name name="FetchStatus" /></Name></AssignStatement></Block></IfStatement></xdd:insert><xdd:insert xdd:stid="68" xdd:path="2/0/1/14/3/1/0/6/1/0/2/0/0/1" xdd:boundary="0"><Name name="FetchStatus.send_data_file" /></xdd:insert><xdd:insert xdd:stid="71" xdd:path="2/0/1/14/3/1_1/1/2/0_1" xdd:parent="m197" xdd:depth="1"><Arguments><Add><StringLiteral value="U3RyZWFtaW5nIA==" /><PrimaryMethodInvocation name="getAbsolutePath"><FieldAccess name="indexFile" /><Arguments /></PrimaryMethodInvocation></Add></Arguments></xdd:insert><xdd:insert xdd:stid="76" xdd:path="2/0/1/14/3/1/0/6/1/0/1/0" xdd:boundary="0_1:m289"><IfStatement><And><Eq><NullLiteral /><FieldAccess name="dataFile" /></Eq><Eq><NullLiteral /><FieldAccess name="indexFile" /></Eq></And></IfStatement></xdd:insert><xdd:insert xdd:stid="79" xdd:path="2/0/1/14/3/1_-1/1/2_1" xdd:parent="m289" xdd:depth="1"><PrimaryMethodInvocationStatement name="writeHeader"><FieldAccess name="chunkedFileWriter"><This /></FieldAccess><Arguments /></PrimaryMethodInvocationStatement></xdd:insert><xdd:insert xdd:stid="84" xdd:path="2/0/1/14/3/1_-1/1/2/1/0/0/0_-1" xdd:parent="m177" xdd:depth="1"><FieldAccess name="dataFile" /></xdd:insert><xdd:insert xdd:stid="87" xdd:path="2/0/1/14/3/1_-1/1/2_-1" xdd:parent="m289" xdd:depth="1"><AssignStatement tid=""><FieldAccess name="chunkedFileWriter"><This /></FieldAccess><StandardInstanceCreation name="ChunkedFileWriter"><ReferenceType name="ChunkedFileWriter" /><Arguments><FieldAccess name="dataFile" /></Arguments></StandardInstanceCreation></AssignStatement></xdd:insert><xdd:insert xdd:stid="90" xdd:path="2/0/1/14/3/1_-1/1/2_-2" xdd:parent="m289" xdd:depth="1"><IfStatement><SimpleMethodInvocation name="isPartitionFinished"><Arguments /></SimpleMethodInvocation><Block><AssignStatement tid=""><FieldAccess name="fetchStatus" /><Name name="FetchStatus.next_partition"><Name name="FetchStatus" /></Name></AssignStatement><ReturnStatement /></Block></IfStatement></xdd:insert><xdd:insert xdd:stid="93" xdd:path="2/0/1/14/3/1/0/6/1/0/1/0/0_2"><FieldAccess name="indexFile" /></xdd:insert><xdd:insert xdd:stid="94" xdd:path="2/0/1/14/3/1_-1/1/1_-2" xdd:parent="m289" xdd:depth="1"><AssignStatement tid=""><FieldAccess name="dataFile" /></AssignStatement></xdd:insert><xdd:insert xdd:stid="97" xdd:path="2/0/1/14/3/1_-1/1/0/1/0/2/0_1" xdd:parent="m289" xdd:depth="5"><Arguments /></xdd:insert><xdd:insert xdd:stid="98" xdd:path="2/0/1/14/3/1_-1/1/0/1/0/2/0_-1" xdd:parent="m289" xdd:depth="5"><PrimaryMethodInvocation name="getFirst"><FieldAccess name="currentPair" /><Arguments /></PrimaryMethodInvocation></xdd:insert><xdd:insert xdd:stid="99" xdd:path="2/0/1/14/3/1_-1/1/0/1/0/0/0_-1" xdd:parent="m289" xdd:depth="5"><PrimaryMethodInvocation name="getSecond"><Arguments /></PrimaryMethodInvocation></xdd:insert><xdd:insert xdd:stid="102" xdd:path="2/0/1/14/0_1"><Parameters name="(LDataOutputStream;)V"><Parameter name="outputStream" dims="0" va="false"><ReferenceType name="DataOutputStream" /></Parameter></Parameters></xdd:insert><xdd:insert xdd:stid="103" xdd:path="2/0/1/14/0_-4"><Modifiers><Private /></Modifiers></xdd:insert><xdd:insert xdd:stid="104" xdd:path="2/0/1/13_1"><MethodDeclaration name="handleSendIndexFile" ___signature="()V"><Modifiers><Private /></Modifiers><Void /><Parameters name="()V" /><Throws name="handleSendIndexFile"><ReferenceType name="IOException" /></Throws><MethodBody><IfStatement><Eq><IntegerLiteral value="0" /><PrimaryMethodInvocation name="streamFile"><FieldAccess name="chunkedFileWriter" /><Arguments /></PrimaryMethodInvocation></Eq><Block><PrimaryMethodInvocationStatement name="close"><FieldAccess name="chunkedFileWriter"><This /></FieldAccess><Arguments /></PrimaryMethodInvocationStatement><PostIncrementStatement><FieldAccess name="currentChunkId" /></PostIncrementStatement><AssignStatement tid=""><FieldAccess name="dataFile" /><Assign tid=""><FieldAccess name="indexFile" /><NullLiteral /></Assign></AssignStatement><PrimaryMethodInvocationStatement name="incrementEntriesScanned"><FieldAccess name="handle" /></PrimaryMethodInvocationStatement><AssignStatement tid=""><FieldAccess name="fetchStatus" /><Name name="FetchStatus.send_data_file"><Name name="FetchStatus" /></Name></AssignStatement></Block><ElseStatement><Block><AssignStatement tid=""><FieldAccess name="fetchStatus" /><Name name="FetchStatus.send_index_file"><Name name="FetchStatus" /></Name></AssignStatement></Block></ElseStatement></IfStatement></MethodBody></MethodDeclaration></xdd:insert><xdd:insert xdd:stid="109" xdd:path="2/0/1/13/4/3/0_1"><Name name="handlerState" /></xdd:insert><xdd:insert xdd:stid="110" xdd:path="2/0/1/13/4/1/2/1/2/2/1/3/1/0/1/0" xdd:boundary="1/2/0/0"><SwitchStatement><FieldAccess name="fetchStatus" /><SwitchBlock><SwitchBlockStatementGroup><ConstantLabel tid="1245e682b3bbd300e145f81174294251" __tid="SLconstant()"><Name name="next_partition" /></ConstantLabel><AssignStatement tid=""><Name name="handlerState" /><SimpleMethodInvocation name="handleNextPartition"><Arguments /></SimpleMethodInvocation></AssignStatement><BreakStatement /></SwitchBlockStatementGroup><SwitchBlockStatementGroup><ConstantLabel tid="ce03d8f0d3e1f59fc26257f871eccb73" __tid="SLconstant()"><Name name="send_data_file" /></ConstantLabel><SimpleMethodInvocationStatement name="handleSendDataFile"><Arguments><Name name="outputStream" /></Arguments></SimpleMethodInvocationStatement><BreakStatement /></SwitchBlockStatementGroup><SwitchBlockStatementGroup><ConstantLabel tid="51642c581cd23c55b10f321acbfef84d" __tid="SLconstant()" /><SimpleMethodInvocationStatement name="handleSendIndexFile"><Arguments /></SimpleMethodInvocationStatement><BreakStatement /></SwitchBlockStatementGroup><SwitchBlockStatementGroup><DefaultLabel /></SwitchBlockStatementGroup></SwitchBlock></SwitchStatement></xdd:insert><xdd:insert xdd:stid="113" xdd:path="2/0/1/13/4/0_1/1/3/1/0/1/0" xdd:parent="m209" xdd:depth="3"><Add><StringLiteral value="SW52YWxpZCBmZXRjaCBzdGF0dXM6IA==" /><FieldAccess name="fetchStatus" /></Add></xdd:insert><xdd:insert xdd:stid="114" xdd:path="2/0/1/13/4/0/1/0/0" xdd:boundary="0"><VariableDeclarator name="handlerState" dims="0" /></xdd:insert><xdd:insert xdd:stid="115" xdd:path="2/0/1/13/4/0/1_-1"><ReferenceType name="StreamRequestHandlerState" /></xdd:insert><xdd:insert xdd:stid="116" xdd:path="2/0/1/9/2/12_6"><AssignStatement tid=""><FieldAccess name="chunkedFileWriter"><This /></FieldAccess><NullLiteral /></AssignStatement></xdd:insert><xdd:insert xdd:stid="117" xdd:path="2/0/1/9/2/12_5"><AssignStatement tid=""><FieldAccess name="dataFile"><This /></FieldAccess><NullLiteral /></AssignStatement></xdd:insert><xdd:insert xdd:stid="118" xdd:path="2/0/1/9/2/12_4"><AssignStatement tid=""><FieldAccess name="indexFile"><This /></FieldAccess><NullLiteral /></AssignStatement></xdd:insert><xdd:insert xdd:stid="119" xdd:path="2/0/1/9/2/12_3"><AssignStatement tid=""><FieldAccess name="currentChunkId"><This /></FieldAccess><IntegerLiteral value="0" /></AssignStatement></xdd:insert><xdd:insert xdd:stid="120" xdd:path="2/0/1/9/2/12_2"><AssignStatement tid=""><FieldAccess name="fetchStatus"><This /></FieldAccess><Name name="FetchStatus.next_partition"><Name name="FetchStatus" /></Name></AssignStatement></xdd:insert><xdd:insert xdd:stid="121" xdd:path="2/0/1/9/2/12_1"><AssignStatement tid=""><FieldAccess name="partitionIterator"><This /></FieldAccess><PrimaryMethodInvocation name="iterator"><TypeMethodInvocation name="Collections" ident="unmodifiableList"><ClassType name="Collections" /><Arguments><FieldAccess name="replicaToPartitionList" /></Arguments></TypeMethodInvocation><Arguments /></PrimaryMethodInvocation></AssignStatement></xdd:insert><xdd:insert xdd:stid="122" xdd:path="2/0/1/9/2/12/1/1/1" xdd:boundary="1/0/1/0"><TypeMethodInvocation name="RebalanceUtils" ident="flattenPartitionTuples"><ClassType name="RebalanceUtils" /><Arguments><StandardInstanceCreation name="HashSet&lt;Pair&lt;Integer,Integer&gt;&gt;"><ReferenceType name="HashSet"><TypeArguments nth="1" name="java.util.HashSet"><ReferenceType name="Pair"><TypeArguments nth="1" name="voldemort.utils.Pair"><ReferenceType name="Integer" /><ReferenceType name="Integer" /></TypeArguments></ReferenceType></TypeArguments></ReferenceType><Arguments /></StandardInstanceCreation></Arguments></TypeMethodInvocation></xdd:insert><xdd:insert xdd:stid="130" xdd:path="2/0/1/9/2/3_1"><LocalVariableDeclarationStatement name="storageEngine[0" /></xdd:insert><xdd:insert xdd:stid="137" xdd:path="2/0/1/8/1/0/1/0/0" xdd:boundary="0/0_-1"><ReferenceType name="Pair"><TypeArguments nth="1" name="voldemort.utils.Pair"><ReferenceType name="Integer" /></TypeArguments></ReferenceType></xdd:insert><xdd:insert xdd:stid="138" xdd:path="2/0/1/7_6"><FieldDeclaration name="chunkedFileWriter[0"><Modifiers><Private /></Modifiers><ReferenceType name="ChunkedFileWriter" /><VariableDeclarator name="chunkedFileWriter" dims="0" /></FieldDeclaration></xdd:insert><xdd:insert xdd:stid="139" xdd:path="2/0/1/7_5"><FieldDeclaration name="dataFile[0"><Modifiers><Private /></Modifiers><ReferenceType name="File" /><VariableDeclarator name="dataFile" dims="0" /></FieldDeclaration></xdd:insert><xdd:insert xdd:stid="140" xdd:path="2/0/1/7_4"><FieldDeclaration name="indexFile[0"><Modifiers><Private /></Modifiers><ReferenceType name="File" /><VariableDeclarator name="indexFile" dims="0" /></FieldDeclaration></xdd:insert><xdd:insert xdd:stid="141" xdd:path="2/0/1/7_3"><FieldDeclaration name="currentPair[0"><Modifiers><Private /></Modifiers><ReferenceType name="Pair"><TypeArguments nth="1" name="voldemort.utils.Pair"><ReferenceType name="Integer" /><ReferenceType name="Integer" /></TypeArguments></ReferenceType><VariableDeclarator name="currentPair" dims="0" /></FieldDeclaration></xdd:insert><xdd:insert xdd:stid="142" xdd:path="2/0/1/7_2"><FieldDeclaration name="currentChunkId[0"><Modifiers><Private /></Modifiers><IntType /><VariableDeclarator name="currentChunkId" dims="0" /></FieldDeclaration></xdd:insert><xdd:insert xdd:stid="143" xdd:path="2/0/1/7_1"><FieldDeclaration name="fetchStatus[0"><Modifiers><Private /></Modifiers><ReferenceType name="FetchStatus" /><VariableDeclarator name="fetchStatus" dims="0" /></FieldDeclaration></xdd:insert><xdd:insert xdd:stid="144" xdd:path="2/0/1/7/0" xdd:boundary="0_-1"><FieldDeclaration name="partitionIterator[0"><ReferenceType name="Iterator"><TypeArguments nth="1" name="java.util.Iterator"><ReferenceType name="Pair"><TypeArguments nth="1" name="voldemort.utils.Pair"><ReferenceType name="Integer" /><ReferenceType name="Integer" /></TypeArguments></ReferenceType></TypeArguments></ReferenceType><VariableDeclarator name="partitionIterator" dims="0" /></FieldDeclaration></xdd:insert><xdd:insert xdd:stid="145" xdd:path="1/24_1"><SingleTypeImportDeclaration name="voldemort.utils.RebalanceUtils" /></xdd:insert><xdd:insert xdd:stid="146" xdd:path="1/8_2"><SingleTypeImportDeclaration name="java.util.Iterator" /></xdd:insert><xdd:insert xdd:stid="147" xdd:path="1/8_1"><SingleTypeImportDeclaration name="java.util.HashSet" /></xdd:insert><xdd:insert xdd:stid="148" xdd:path="1/7_1"><SingleTypeImportDeclaration name="java.util.Collections" /></xdd:insert><xdd:insert xdd:stid="149" xdd:path="1/3_1"><SingleTypeImportDeclaration name="java.io.FileNotFoundException" /></xdd:insert><xdd:move xdd:mid="61" xdd:path_from="2/0/1/7/1" xdd:path_to="2/0/1/9/2/3_1/0_-1" xdd:parent="130" xdd:depth="1" /><xdd:move xdd:mid="242" xdd:path_from="2/0/1/9/2/7/1" xdd:path_to="2/0/1/9/2/3_1/0/0" xdd:parent="m62" xdd:depth="1" /><xdd:move xdd:mid="62" xdd:path_from="2/0/1/7/2" xdd:path_to="2/0/1/9/2/3_1/0_1" xdd:parent="130" xdd:depth="1" /><xdd:move xdd:mid="234" xdd:path_from="2/0/1/13/4/1/0/0/0/1" xdd:path_to="2/0/1/9/2/6/1/0/1/0_-1/0_-1" xdd:parent="125" xdd:depth="1" xdd:mctl="D" /><xdd:move xdd:mid="209" xdd:path_from="2/0/1/13/4/1/2/1/2/0/1/0" xdd:path_to="2/0/1/13/4/0_1/1/3/0_1" xdd:parent="110" xdd:depth="3" xdd:boundary_from="0/1/0" /><xdd:move xdd:mid="301" xdd:path_from="2/0/1/13/4/1/2/1/2/2/1/8" xdd:path_to="2/0/1/13_1/4/0/1/0_-1" xdd:parent="104" xdd:depth="4" /><xdd:move xdd:mid="50" xdd:path_from="2/0/1/13/4/1/2/1/2/2/1/9/1" xdd:path_to="2/0/1/13_1/4/0/1/3/0_1" xdd:parent="104" xdd:depth="5" /><xdd:move xdd:mid="269" xdd:path_from="2/0/1/13/4/1/2/1/2/2/1/0/1/0/0/0" xdd:path_to="2/0/1/14/3/1_-1/1/0/1/0/0/0/0_-1" xdd:parent="99" xdd:depth="1" /><xdd:move xdd:mid="205" xdd:path_from="2/0/1/13/4/1/2/1/2/2/1/2/1/0" xdd:path_to="2/0/1/14/3/1_-1/1/1/0_1" xdd:parent="94" xdd:depth="1" /><xdd:move xdd:mid="282" xdd:path_from="2/0/1/13/4/1/2/1/2/2/1/1/1/0" xdd:path_to="2/0/1/14/3/1/0/6/1/0/1/0/0_3" /><xdd:move xdd:mid="179" xdd:path_from="2/0/1/13/4/1/2/1/2/2/1/7/0/1" xdd:path_to="2/0/1/14/3/1_-1/1/2/1/1/0_1" xdd:parent="87" xdd:depth="3" /><xdd:move xdd:mid="178" xdd:path_from="2/0/1/13/4/1/2/1/2/2/1/6/1/0/0" xdd:path_to="2/0/1/14/3/1_-1/1/2/1/0/0_-1" xdd:parent="m289" xdd:depth="4" /><xdd:move xdd:mid="107" xdd:path_from="2/0/1/13/4/1/2/1/2/2/1/3/1/0/1/1" xdd:path_to="2/0/1/14/3/1_-1/1/2/1/0/0/0_1" xdd:parent="m177" xdd:depth="1" /><xdd:move xdd:mid="177" xdd:path_from="2/0/1/13/4/1/2/1/2/2/1/6/1/0/1" xdd:path_to="2/0/1/14/3/1_-1/1/2/1/0/0_1" xdd:parent="m289" xdd:depth="4" xdd:boundary_from="0;1" /><xdd:move xdd:mid="289" xdd:path_from="2/0/1/13/4/1/2/1/2/2/1" xdd:path_to="2/0/1/14/3/1/0/6/1/0/1/0" xdd:boundary_from="0/1/0/0/0;0/1/0/0/1/0;0/1/0/2/0;0/1/0/2/1;1;2;3;4/0/0;4/0/1;5;6/1/0/0;6/1/0/1;7;8;9" xdd:boundary_to="1_-1" /><xdd:move xdd:mid="193" xdd:path_from="2/0/1/13/4/1/2/1/2/2/1/5" xdd:path_to="2/0/1/14/3/1_1/1/0_-1" xdd:parent="67" xdd:depth="2" /><xdd:move xdd:mid="180" xdd:path_from="2/0/1/14/3/1/1/0/0/1/0/1" xdd:path_to="2/0/1/14/3/1_1/1/0/0_1" xdd:parent="67" xdd:depth="3" /><xdd:move xdd:mid="197" xdd:path_from="2/0/1/13/4/1/2/1/2/2/1/3" xdd:path_to="2/0/1/14/3/1_1/1/2_-1" xdd:parent="67" xdd:depth="2" xdd:boundary_from="1" /><xdd:move xdd:mid="251" xdd:path_from="2/0/1/13/4/1/1" xdd:path_to="2/0/1/14_1/3/1/2/0/0/1/0" xdd:parent="61" xdd:depth="7" xdd:boundary_from="1" /><xdd:move xdd:mid="246" xdd:path_from="2/0/1/13/4/2" xdd:path_to="2/0/1/14_1/3/1/2/0/1_-1" xdd:parent="61" xdd:depth="5" /><xdd:move xdd:mid="65" xdd:path_from="2/0/1/14/3/1/0/4/1/0" xdd:path_to="2/0/1/14_3/3/0/1/0" xdd:parent="57" xdd:depth="4" /><xdd:move xdd:mid="249" xdd:path_from="2/0/1/14/3/0" xdd:path_to="2/0/1/14_5/0/2_-2" xdd:parent="27" xdd:depth="2" xdd:boundary_from="1/0" /><xdd:move xdd:mid="260" xdd:path_from="2/0/1/14/3/1/0/3" xdd:path_to="2/0/1/14_5/0/2_-1" xdd:parent="27" xdd:depth="2" xdd:boundary_from="1/0" /><xdd:move xdd:mid="306" xdd:path_from="2/0/1/14/1" xdd:path_to="2/0/1/14_5/0/3/0_-1" xdd:parent="27" xdd:depth="3" /><xdd:move xdd:mid="97" xdd:path_from="2/0/1/14/3/0/1/0/0/0" xdd:path_to="2/0/1/14_5/0/3/1/2/1/0/0_-1" xdd:parent="45" xdd:depth="1" /><xdd:move xdd:mid="195" xdd:path_from="2/0/1/14/3/0/1/0" xdd:path_to="2/0/1/14_5/0/3/1/2/0_1" xdd:parent="27" xdd:depth="5" xdd:boundary_from="0" /><xdd:move xdd:mid="310" xdd:path_from="2/0/1/14/3/1/0/3/1/0" xdd:path_to="2/0/1/14_5/0/3/1/3/0_1" xdd:parent="27" xdd:depth="5" /><xdd:move xdd:mid="231" xdd:path_from="2/0/1/14/3/1/0/0" xdd:path_to="2/0/1/14_5/0/5/3/0_-1" xdd:parent="27" xdd:depth="4" /><xdd:move xdd:mid="185" xdd:path_from="2/0/1/14/3/1/0/1" xdd:path_to="2/0/1/14_5/0/5/3/0_1" xdd:parent="27" xdd:depth="4" /><xdd:move xdd:mid="257" xdd:path_from="2/0/1/14/3/1/0/2" xdd:path_to="2/0/1/14_5/0/5/3/0_2" xdd:parent="27" xdd:depth="4" /><xdd:move xdd:mid="293" xdd:path_from="2/0/1/14/3/1/0/6/1/0/1/0/1" xdd:path_to="2/0/1/14_5/0/6/3/0/1/0" xdd:parent="27" xdd:depth="6" xdd:boundary_from="1" /><xdd:move xdd:mid="83" xdd:path_from="2/0/1/14/3/1/0/6/0/2/0/1" xdd:path_to="2/0/1/14_5/0/6/3/1/1/0/1/0/1/0_1" xdd:parent="27" xdd:depth="10" /><xdd:move xdd:mid="79" xdd:path_from="2/0/1/14/3/1/0/6/1/2/0" xdd:path_to="2/0/1/14_5/0/6/3/1/1/4/0_-1" xdd:parent="27" xdd:depth="7" /><xdd:delete xdd:path="1/10" /><xdd:delete xdd:path="2/0/1/7" xdd:boundary="0;1;2" /><xdd:delete xdd:path="2/0/1/8/1" xdd:boundary="0/1" /><xdd:delete xdd:path="2/0/1/9/2/7" xdd:boundary="1" /><xdd:delete xdd:path="2/0/1/13/4/0/0" /><xdd:delete xdd:path="2/0/1/13/4/0/1/0/0/1" /><xdd:delete xdd:path="2/0/1/13/4/0/1" xdd:boundary="0/0" /><xdd:delete xdd:path="2/0/1/13/4/1/1/1" /><xdd:delete xdd:path="2/0/1/13/4/1/2/1/2/0/1/0/0/1/0" /><xdd:delete xdd:path="2/0/1/13/4/1/2/1/2/2/1/0/1/0/0/1/0" /><xdd:delete xdd:path="2/0/1/13/4/1/2/1/2/2/1/0/1/0/2/0" /><xdd:delete xdd:path="2/0/1/13/4/1/2/1/2/2/1/0/1/0/2/1" /><xdd:delete xdd:path="2/0/1/13/4/1/2/1/2/2/1/1" xdd:boundary="1/0" /><xdd:delete xdd:path="2/0/1/13/4/1/2/1/2/2/1/2" xdd:boundary="1/0" /><xdd:delete xdd:path="2/0/1/13/4/1/2/1/2/2/1/3/1" xdd:boundary="0/1/0;0/1/1" /><xdd:delete xdd:path="2/0/1/13/4/1/2/1/2/2/1/4/0/0" /><xdd:delete xdd:path="2/0/1/13/4/1/2/1/2/2/1/4/0/1" /><xdd:delete xdd:path="2/0/1/13/4/1/2/1/2/2/1/6/1/0/1/0" /><xdd:delete xdd:path="2/0/1/13/4/1/2/1/2/2/1/6/1/0/1/1" /><xdd:delete xdd:path="2/0/1/13/4/1/2/1/2/2/1/7" xdd:boundary="0/1" /><xdd:delete xdd:path="2/0/1/13/4/1/2/1/2/2/1/9" xdd:boundary="1" /><xdd:delete xdd:path="2/0/1/13/4/1" xdd:boundary="0/0/0/1;1;2/1/2/0/1/0;2/1/2/2/1" /><xdd:delete xdd:path="2/0/1/13/4/3/0" /><xdd:delete xdd:path="2/0/1/14/3/0/1/0/0" xdd:boundary="0" /><xdd:delete xdd:path="2/0/1/14/3/1/0/6/1/0/1/0/0" /><xdd:delete xdd:path="2/0/1/14/3/1/0/6/1/0/1/0/1/1" /><xdd:delete xdd:path="2/0/1/14/3/1" xdd:boundary="0/0;0/1;0/2;0/3;0/4/1/0;0/6/0/2/0/1;0/6/1/0/1/0;0/6/1/0/2;0/6/1/2/0;1/0/0/1/0/1" /><xdd:delete xdd:path="2/0/1/9/2/6" /><xdd:move xdd:mid="320" xdd:path_from="2/0/1/9/2/4/1/0" xdd:path_to="2/0/1/9/2/5/0_1" xdd:mctl="F" /><xdd:delete xdd:path="2/0/1/9/2/5/1" /><xdd:delete xdd:path="1/25" /><xdd:delete xdd:path="2/0/1/9/2/4" xdd:boundary="1/0" /></xdd:delta>